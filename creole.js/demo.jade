extends ../layout

block title
  | creole.js Live Demo

block mainMenu
  mixin mainMenu("creole.js/demo.html")

block content
  .span8
    #preview
    textarea#source.span8(rows="8").
      = creole.js Live Demo
      
      creole.js is a [[http://wikicreole.org/wiki/Creole1.0|Creole 1.0]] parser for javascript.
      
      It can run on both client side and server side.
      
      ----
      Edit the source below.
  .span4
    img(src="http://wikicreole.org/attach/CheatSheet/creole_cheat_sheet.png")

append scripts
  script(src="creole.js")
  script(src="html.js")
  script
    var escapes = {'&': '&amp;', '"': '&quot;', '<': '&lt;', '>': '&gt;'};
    var preview = function() {
      var result = [];
      var builder = new html.Builder(function(value) {
        result.push(value.replace(/[&"<>]/g, function(c) {
          return escapes[c];
        }));
      }, function(value) {
        result.push(value);
      });
      creole.parse(builder, $('#source').val());
      $('#preview').html(result.join(''));
    };
    $('#source').data('preview', null).on('input', function() {
      clearTimeout($(this).data('preview'));
      $(this).data('preview', setTimeout(preview, 500));
    });
    preview();
